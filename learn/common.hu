#include <algorithm>
using namespace std;

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "Aborting\n"); \
            exit(1); \
        } \
    } while (0)

template<typename T>
void fillOnes(T *x, int n) {
    fill_n(x, n, 1);
}